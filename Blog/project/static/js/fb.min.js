function doLoginAPI(e){FB.api("/me?fields=id,name,email",function(n){$.ajax({url:"/account/checkfid",type:"POST",data:{f_:n.id,e_:n.email},success:function(o){var i=JSON.parse(o);200===i.code?$.ajax({url:"/registerfb",type:"post",data:{u_:n.name,e_:n.email,t_:e,f_:n.id},success:function(o){var i=JSON.parse(o);201===i.code?($(".spinner").hide(),show_stack_bar_top("error","Oh no!",i.message)):ajaxLoginFB(n.email,e,n.id)}}):201===i.code?ajaxLoginFB(n.email,e,n.id):($(".spinner").hide(),show_stack_bar_top("error","Oh no!",i.message))}})})}function ajaxLoginFB(e,n,o){$.ajax({url:"/loginfb",type:"post",data:{e_:e,t_:n,f_:o},success:function(e){var n=JSON.parse(e);200===n.code?location.href="/":($(".spinner").hide(),show_stack_bar_top("error","Oh no!",n.message))}})}function logoutFB(){FB.logout(function(e){})}function checkLoginFB(){FB.getLoginStatus(function(e){$(".spinner").show(),"connected"===e.status?doLoginAPI(e.authResponse.accessToken):(FB.login(function(e){},{scope:"public_profile,email,user_about_me"}),$(".spinner").hide())})}window.fbAsyncInit=function(){FB.init({appId:"156445348396184",cookie:!0,xfbml:!0,version:"v2.12"})},function(e,n,o){var i,t=e.getElementsByTagName(n)[0];e.getElementById(o)||((i=e.createElement(n)).id=o,i.src="https://connect.facebook.net/vi_VI/sdk.js",t.parentNode.insertBefore(i,t))}(document,"script","facebook-jssdk");